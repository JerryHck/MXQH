
<div class="panel-default" cg-busy="qz.promise">
    <div class="panel-body no-padder m-t-xxs">
        <div class="col-sm-6 padder-xs">
            <div class="panel panel-default" ng-form="qz.OrderForm">
                <div class="panel-heading font-bold  text-center">出货单[<span class="font-bold text-info">{{ qz.ItemData.DeliverNo }}</span>]扫码操作</div>
                <div class="panel-body">
                    <div class="form-horizontal">
                        <div class="form-group-xs col-md-12">
                            <label class="col-lg-3 control-label padder-xxs">出货单号:</label>
                            <div class="col-lg-9 form-control-static text-info font-bold">
                                {{ qz.ItemData.DeliverNo }}
                            </div>
                        </div>
                        <div class="form-group-xs col-md-12">
                            <label class="col-lg-3 control-label padder-xxs">代理商:</label>
                            <div class="col-lg-9 form-control-static">
                                {{ qz.ItemData.Agent.AgentName }}({{ qz.ItemData.Agent.AgentNo }})
                            </div>
                        </div>
                        <div class="form-group-xs col-md-12">
                            <label class="col-lg-3 control-label padder-xxs">料号:</label>
                            <div class="col-lg-9 form-control-static">
                                {{ qz.ItemData.MateNo }}
                            </div>
                        </div>
                        <div class="form-group-xs col-md-12">
                            <label class="col-lg-3 control-label padder-xxs">出货数量:</label>
                            <div class="col-lg-3 form-control-static">
                                {{ qz.ItemData.DeliverNum }}
                            </div>
                            <label class="col-lg-3 control-label padder-xxs">已扫数量:</label>
                            <div class="col-lg-3 form-control-static h4 text-success">
                                {{ qz.ItemData.HavePackQty }}
                            </div>
                        </div>
                        <div class="form-group-xs col-md-12">
                            <label class="col-lg-3 control-label padder-xxs">SN码/箱号:</label>
                            <div class="col-lg-9" ng-class="{ 'has-error' : qz.OrderForm.BSN.$invalid }">
                                <input type="text" class="form-control" name="BSN" ng-model="qz.Item.BSN" placeholder="SN/箱号"
                                       ng-keypress="qz.KeyDonwSnCode($event)" required>
                                <div class="h6 text-danger">注:扫描枪请设定自动回车功能，如果手动输入则需按回车键。</div>
                            </div>
                        </div>
                        <div class="form-group-xs col-md-12">
                            <div class="col-lg-offset-3 col-lg-9 padder-md">
                                <button type="submit" ng-if="qz.ItemData.HavePackQty>=qz.ItemData.DeliverNum" class="btn btn-success" ng-click="qz.Done(false)" ng-confirm="{text:'确定要完成出货单吗？'}">
                                    完成出货单
                                </button>
                                <button type="submit" ng-if="qz.ItemData.HavePackQty<qz.ItemData.DeliverNum" class="btn btn-success" ng-click="qz.Done(true)" ng-confirm="{text:'强制包装会自动根据已包装数量更新包装箱的包装数量并结束包装'}"
                                        ng-disabled="!qz.ItemData.HavePackQty || qz.ItemData.HavePackQty == 0">
                                    强制完成出货单
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="panel panel-default">
                <div class="panel-heading font-bold text-center">
                    信息显示
                </div>
                <div class="panel-body scroll-y" style="max-height:250px">
                    <div class="list-group">
                        <ul class="list-group bg-white">
                            <li class="list-group-item" ng-repeat="item in qz.MesList | limitTo:100" ng-class="{ 'text-danger' : !item.IsOk, 'text-success':item.IsOk }">
                                <span herf class="pull-left">
                                    <i class="glyphicon" ng-class="{ 'glyphicon-remove' : !item.IsOk, 'glyphicon-ok':item.IsOk }"></i>
                                </span>
                                <div class="clear">
                                    <div>{{ item.Msg }}</div>
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-sm-6 padder-xs">
            <div class="panel panel-default">
                <div class="panel-heading font-bold text-center">
                    出货单SN列表
                    <span title="清空所有SN"><a class="text-danger" ng-confirm="{text:'确定要清空所有SN吗'}" ng-click="qz.ClearBSN()"><i class="glyphicon glyphicon-remove"></i></a></span>
                </div>
                <div class="panel-body padder-xs" style="min-height:400px">
                    <div class="input-group no-padder col-md-offset-1 col-md-10">
                        <input type="text" class="form-control input-sm" ng-model="qz.SerBSN" />
                        <span class="text-success input-group-btn" ng-click="qz.Search()">
                            <button type="submit" class="btn btn-sm btn-success" >
                                <i class="glyphicon glyphicon-search"></i>
                            </button>
                        </span>
                    </div>
                    <div class="scroll-y m-t-xs" style="max-height:530px">
                        <div class="list-group">
                            <div class="list-group-item text-center" ng-repeat="sn in qz.SNList">
                                <span class="pull-left badge badge-sm bg-danger pull-left">{{ sn.RowNum }}</span>
                                <span ng-class="{ 'font-bold text-success' : sn.BSN==qz.StaticBSN }">{{ sn.BSN }}</span>
                                <span class="pull-right"><a class="text-danger" ng-click="qz.ClearBSN(sn.BSN)" ng-confirm="{text:'确定移除该SN吗'}"><i class="glyphicon glyphicon-remove"></i></a></span>
                            </div>
                        </div>
                        <div class="col-md-12 m-t-n-md text-center " ng-if="qz.page.total>qz.page.size ">
                            <div uib-pagination total-items="qz.page.total " ng-model="qz.page.index " items-per-page="qz.page.size " max-size="5" first-text="<<" previous-text="< "
                                 ng-change="qz.PageChange() " next-text="> " last-text=">> " boundary-links="false " boundary-link-numbers="true "></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="bg-light padder-v text-center col-md-12">
    <button class="btn btn-primary" type="button" ng-click="qz.cancel()">关闭</button>
</div>
