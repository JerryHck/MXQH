<div class="modal-header">
    <span class="modal-title h3">入库信息</span>
    <button class="btn btn-warning pull-right" type="button" ng-click="rrdc.Cancel()">取消</button>
</div>
<div class="modal-body wrapper-sm" ng-form="DialogForm">
    <div class="panel-default" cg-busy="rrdc.promise">
        <div class="panel-body no-padder m-t-xxs">
            <div class="col-sm-5 padder-xs">
                <div class="panel panel-default" ng-form="rrdc.OrderForm">
                    <div class="panel-heading font-bold  text-center">入库单单[<span class="font-bold text-info">{{ rrdc.Item.DocNo }}</span>]扫码操作</div>
                    <div class="panel-body">
                        <div class="form-horizontal">
                            <div class="form-group-xs col-md-12">
                                <label class="col-lg-3 control-label padder-xxs">入库单号:</label>
                                <div class="col-lg-9 form-control-static text-info font-bold">
                                    {{ rrdc.Item.DocNo }}
                                </div>
                            </div>
                            <div class="form-group-xs col-md-12">
                                <label class="col-lg-3 control-label padder-xxs">入库人:</label>
                                <div class="col-lg-3 form-control-static">
                                    {{ rrdc.Item.Operator }}
                                </div>
                                <label class="col-lg-3 control-label padder-xxs" >入库时间:</label>
                                <div class="col-lg-3 form-control-static" >
                                    {{ rrdc.Item.RcvDate }}
                                </div>
                            </div>
                            <div class="form-group-xs col-md-12">
                                <label class="col-lg-3 control-label padder-xxs">样品阶段:</label>
                                <div class="col-lg-3 form-control-static">
                                    <select class="form-control"  ng-model="rrdc.Progress">
                                        <option value="P0">P0</option>
                                        <option value="P1">P1</option>
                                        <option value="P2">P2</option>
                                    </select>
                                </div>
                                <label class="col-lg-3 control-label padder-xxs">样机状态:</label>
                                <div class="col-lg-3 form-control-static h4 text-success">
                                    <select class="form-control" ng-model="rrdc.Status">
                                        <option value="良好">良好</option>
                                        <option value="不良">不良</option>
                                        <option value="报废">报废</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-group-xs col-md-12">
                                <label class="col-lg-3 control-label padder-xxs">已扫数量:</label>
                                <div class="col-lg-3 form-control-static">
                                    {{ rrdc.Item.RcvCount }}
                                </div>
                                <label ng-if="rrdc.IsSN=='0'" class="col-lg-3 control-label padder-xxs">工单数量:</label>
                                <div ng-if="rrdc.IsSN=='0'" class="col-lg-3 form-control-static">
                                    {{ rrdc.WorkOrder.Quantity }}
                                </div>
                            </div>
                            <div ng-if="rrdc.Item.DocType=='旧料入库'" class="form-group-xs col-md-12">
                                <label class="col-lg-3 control-label padder-xxs">料号:</label>
                                <div class="col-lg-6 form-control-static" ng-class="{ 'has-error' : rrdc.OrderForm.MaterialID.$invalid }">
                                    <div basic-select="MaterialName" placeholder="料号" ng-model="rrdc.Item.MaterialID" ng-name="MaterialID" ng-required="true" select-class="text-xs"></div>
                                </div>
                            </div>
                            <div class="form-group-xs col-md-12">
                                <label class="col-lg-3 control-label padder-xxs">SN码:</label>
                                <div class="col-lg-9" ng-class="{ 'has-error' : rrdc.OrderForm.SNCode.$invalid }">
                                    <input autocomplete="off" type="text" class="form-control" name="SNCode" ng-model="rrdc.SNCode" placeholder="SN码/内控码/工单"
                                           ng-keypress="rrdc.KeyDonwSnCode($event)" required>
                                    <div class="h6 text-danger">注:扫描枪请设定自动回车功能，如果手动输入则需按回车键。</div>
                                </div>
                            </div>
                            <div class="form-group-xs col-md-12">
                                <label class="col-lg-3 control-label padder-xxs">备注:</label>
                                <div class="col-lg-9 form-control-static h4 text-success">
                                    <textarea name="Remark" rows="2" ng-model="rrdc.Remark" class="form-control col-lg-12"></textarea>
                                </div>
                            </div>
                            <div class="form-group-xs col-md-12">
                                <span class="btn-group col-lg-offset-3 padder">
                                    <label class="btn btn-default btn-success reset" ng-model="rrdc.IsSN" uib-btn-radio="1">SN码录入</label>
                                    <label class="btn btn-default btn-success reset" ng-model="rrdc.IsSN" uib-btn-radio="0">整单录入</label>
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="panel panel-default">
                    <div class="panel-heading font-bold text-center">
                        信息显示
                    </div>
                    <div class="panel-body scroll-y" style="max-height:250px">
                        <div class="list-group">
                            <ul class="list-group bg-white">
                                <li class="list-group-item" ng-repeat="item in rrdc.MesList | limitTo:100" ng-class="{ 'text-danger' : !item.IsOk, 'text-success':item.IsOk }">
                                    <span herf class="pull-left">
                                        <i class="glyphicon" ng-class="{ 'glyphicon-remove' : !item.IsOk, 'glyphicon-ok':item.IsOk }"></i>
                                    </span>
                                    <div class="clear">
                                        <div>{{ item.Msg }}</div>
                                    </div>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-sm-7 padder-xs">
                <div class="panel panel-default">
                    <div class="panel-heading font-bold text-center">
                        入库单SN列表
                        <span title="清空所有SN"><a class="text-danger" ng-confirm="{text:'确定要清空所有SN吗'}" ng-click="rrdc.ClearBSN()"><i class="glyphicon glyphicon-remove"></i></a></span>
                    </div>
                    <div class="panel-body padder-md" style="min-height:400px">
                        <div class="input-group col-md-6">
                            <input autocomplete="off" type="text" class="form-control input-sm" ng-model="rrdc.SerSNCode" />
                            <span class="text-success input-group-btn" ng-click="rrdc.Search()">
                                <button type="submit" class="btn btn-sm btn-success">
                                    <i class="glyphicon glyphicon-search"></i>
                                </button>
                            </span>
                        </div>
                        <div class="scroll-y m-t-xs" style="max-height:530px">
                            <div class="table-responsive" ng-form="rrdc.EditForm">
                                <table class="table one-line no-padder">
                                    <thead>
                                        <tr>
                                            <td style="width:80px;">删除</td>
                                            <td style="width:120px;">SN编码</td>
                                            <td style="width:80px;">阶段</td>
                                            <td style="width:80px;">状态</td>
                                            <td style="width:100px;">料号</td>
                                            <td style="width:120px;">品名</td>
                                            <td style="width:220px;">规格</td>
                                            <td style="width:220px;">备注</td>
                                        </tr>
                                    </thead>
                                    <tr ng-repeat="sn in rrdc.SNList">
                                        <td>
                                            <span ng-if="!sn.IsEdit">
                                                <button class="btn btn-xs btn-success" ng-click="rrdc.Edit(sn)"><i class="glyphicon glyphicon-edit"></i></button>
                                                <button class="btn btn-xs btn-danger" ng-click="rrdc.ClearBSN(sn.SNCode)" ng-confirm="{text:'确定移除该SN吗'}"><i class="glyphicon glyphicon-remove"></i></button>
                                            </span>
                                            <span ng-if="sn.IsEdit">
                                                <button class="btn btn-xs btn-success" ng-disabled="rrdc.EditForm.$invalid" ng-click="rrdc.SaveEdit($index)"><i class="glyphicon glyphicon-save"></i></button>
                                                <button class="btn btn-xs btn-warning" ng-click="sn.IsEdit=!sn.IsEdit"><i class="fa fa-undo"></i></button>
                                            </span>

                                        </td>
                                        <td style="white-space:normal;word-break:normal;">{{sn.SNCode}}</td>
                                        <td>
                                            <span ng-if="!sn.IsEdit" >{{sn.Progress}}</span>
                                            <div ng-if="sn.IsEdit">
                                                <select class="form-control" ng-model="rrdc.EditItem.Progress">
                                                    <option value="P0">P0</option>
                                                    <option value="P1">P1</option>
                                                    <option value="P2">P2</option>
                                                </select>
                                            </div>
                                        </td>
                                        <td>
                                            <span ng-if="!sn.IsEdit" >{{sn.Status}}</span>
                                            <div ng-if="sn.IsEdit">
                                                <select class="form-control" ng-model="rrdc.EditItem.Status">
                                                    <option value="良好">良好</option>
                                                    <option value="不良">不良</option>
                                                    <option value="报废">报废</option>
                                                </select>
                                            </div>
                                        </td>
                                        <td>{{sn.MaterialCode}}</td>
                                        <td style="white-space:normal;word-break:normal;" title="{{sn.MaterialName}}">{{sn.MaterialName}}</td>
                                        <td style="white-space:normal;word-break:normal;" title="{{sn.Spec}}">{{sn.Spec}}</td>
                                        <td style="white-space:normal;word-break:normal;">
                                            <span ng-if="!sn.IsEdit">{{sn.Remark}}</span>
                                            <textarea ng-if="sn.IsEdit" ng-model="rrdc.EditItem.Remark" rows="5" class="form-control"></textarea>
                                        </td>
                                    </tr>
                                </table>
                            </div>
                            <div class="col-md-12 m-t-n-md text-center " ng-if="rrdc.page.total>rrdc.page.pageSize ">
                                <div uib-pagination total-items="rrdc.page.total " ng-model="rrdc.page.pageIndex " items-per-page="rrdc.page.pageSize " max-size="5" first-text="<<" previous-text="< "
                                     ng-change="rrdc.GetDetail() " next-text="> " last-text=">> " boundary-links="false " boundary-link-numbers="true "></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>



