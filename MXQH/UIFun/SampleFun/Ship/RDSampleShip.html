<uib-tabset active="active" type="tabs" class="h-100" cg-busy="rdssc.promise">
    <uib-tab index="0">
        <uib-tab-heading class="h5">样机出库</uib-tab-heading>
        <div class="wrapper-md">
            <div class="input-group m-b-xxs">
                <div class="form-inline">
                    <button class="btn btn-sm btn-success " ng-click="rdssc.Add() "><i class="glyphicon glyphicon-plus "></i>新增</button>
                    <div class="form-group">
                        <div class="input-group">
                            <input autocomplete="off" type="text" class="form-control" ng-model="rdssc.page.DocNo" placeholder="单号">
                            <span class="input-group-addon">
                                <a><i ng-click="rdssc.page.DocNo = undefined" class="glyphicon glyphicon-trash text-danger"></i></a>
                            </span>
                        </div>
                        <div class="input-group">
                            <input autocomplete="off" type="text" class="form-control" ng-model="rdssc.page.Borrower" placeholder="领借人">
                            <span class="input-group-addon">
                                <a><i ng-click="rdssc.page.Borrower = undefined" class="glyphicon glyphicon-trash text-danger"></i></a>
                            </span>
                        </div>
                        <div class="input-group">
                            <div class="input-group">
                                <input autocomplete="off" type="text" date-time-picker class="form-control" name="SD" placeholder="开始日期" option="rdssc.dt1"
                                       ng-model="rdssc.page.SD">
                                <span class="input-group-addon">
                                    <a><i ng-click="rdssc.page.SD = undefined" class="glyphicon glyphicon-trash text-danger"></i></a>
                                </span>
                            </div>
                        </div>
                        <div class="input-group">
                            <input autocomplete="off" type="text" date-time-picker class="form-control" name="ED" placeholder="结束日期" option="rdssc.dt2"
                                   ng-model="rdssc.page.ED">
                            <span class="input-group-addon">
                                <a><i ng-click="rdssc.page.ED = undefined" class="glyphicon glyphicon-trash text-danger"></i></a>
                            </span>
                        </div>
                    </div>
                    <button class="btn btn-sm btn-info " ng-click="rdssc.Search() "><i class="glyphicon glyphicon-search "></i>查询</button>
                    <!--<button class="btn btn-sm btn-success " ng-click="rdssc.Export() "><i class="glyphicon glyphicon-export "></i>导出</button>-->
                </div>
            </div>
        </div>
        <div class="col-md-12 scroll-x" style="min-height:300px;">
            <table class="table pad-xs">
                <thead>
                    <tr>
                        <td style="width:60px ">编辑</td>
                        <td style="width:60px ">序号</td>
                        <td style="width:120px ">单号</td>
                        <td style="width:120px ">单据类型</td>
                        <td style="width:120px ">料号</td>
                        <td style="width:120px ">品名</td>
                        <td style="width:60px ">阶段</td>
                        <td style="width:60px ">数量</td>
                        <td style="width:100px ">出库人</td>
                        <td style="width:110px ">出库日期</td>
                        <td style="width:110px ">计划归还日</td>
                        <td style="width:140px ">项目号</td>
                        <td style="width:140px ">项目名称</td>
                        <td style="width:100px ">领借部门</td>
                        <td style="width:100px ">领借人</td>
                        <td style="width:100px ">客户</td>
                        <td style="width:200px ">备注</td>
                    </tr>
                </thead>
                <tbody>
                    <tr ng-if="rdssc.IsInsert" ng-form="rdssc.InsertForm">
                        <td>
                            <button class="btn btn-xs btn-success" ng-disabled="rdssc.InsertForm.$invalid" ng-click="rdssc.SaveInsert()"><i class="glyphicon glyphicon-save"></i></button>
                            <button class="btn btn-xs btn-warning" ng-click="rdssc.IsInsert=false"><i class="fa fa-undo"></i></button>
                        </td>
                        <td></td>
                        <td>
                            {{rdssc.NewItem.DocNo}}
                        </td>
                        <td>
                            <div ng-class="{ 'has-error': rdssc.InsertForm.DocType.$invalid }">
                                <div config-select ng-model="rdssc.NewItem.DocType" config-option="rdssc.DocTypeList" auto-first="false" ng-name="DocType" placeholder="单据类型"></div>
                            </div>
                        </td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td>
                            <div ng-class="{ 'has-error': rdssc.InsertForm.Operator.$invalid }">
                                <input type="text" name="Operator" class="form-control" placeholder="出库人" ng-model="rdssc.NewItem.Operator" required />
                            </div>
                        </td>
                        <td>
                            <div ng-class="{ 'has-error': rdssc.InsertForm.DeliverDate.$invalid }">
                                <input type="text" date-picker name="DeliverDate" class="form-control" placeholder="出库库日期" ng-model="rdssc.NewItem.DeliverDate" option="rdssc.DateOption" required />
                            </div>
                        </td>
                        <td>
                            <div>
                                <input type="text" date-picker name="PlanReturnDate" class="form-control" placeholder="计划归还日" ng-model="rdssc.NewItem.PlanReturnDate" option="rdssc.DateOption" />
                            </div>
                        </td>
                        <td>
                            <div>
                                <div basic-select="PLMProject" name="Project" placeholder="PLM项目号"
                                     ng-model="rdssc.Project" >
                                </div>
                            </div>
                        </td>
                        <td>
                            {{rdssc.Project.WorkName}}
                        </td>
                        <td>
                            <div ng-class="{ 'has-error': rdssc.InsertForm.Dept.$invalid }">
                                <div basic-select="TPDicRDDept" name="Dept" placeholder="领借部门"
                                     ng-model="rdssc.Dept" required>
                                </div>
                            </div>
                        </td>
                        <td>
                            <div ng-class="{ 'has-error': rdssc.InsertForm.Borrower.$invalid }">
                                <input type="text" name="Borrower" class="form-control" placeholder="领借人" ng-model="rdssc.Borrower" required />
                                <!--<div basic-select="TPDicRDUser" name="Borrower" placeholder="领借人"
                                     ng-model="rdssc.Borrower" required>
                                </div>-->
                            </div>
                        </td>
                        <td>
                            <div>
                                <div basic-select="TPDicRDCustomer" name="Customer" placeholder="客户"
                                     ng-model="rdssc.Customer">
                                </div>
                            </div>
                        </td>
                        <td>
                            <div>
                                <textarea class="form-control" name="Remark" placeholder="备注" ng-model="rdssc.NewItem.Remark" rows="3"></textarea>
                            </div>
                        </td>
                    </tr>
                    <tr ng-repeat="item in rdssc.List " ng-form="EditForm">
                        <td style="white-space:normal;word-break:normal;">
                            <span ng-if="!item.IsEdit">
                                <button class="btn btn-xs btn-success" ng-click="rdssc.OpenScan(item)"><i class="fa fa-th"></i>扫码</button>
                                <button class="btn btn-xs btn-primary" title="编辑" ng-click="rdssc.Edit(item)"><i class="glyphicon glyphicon-edit"></i></button>
                                <button class="btn btn-xs btn-danger" title="删除" ng-confirm="{text:'确定要删除['+item.DocNo+']及其明细数据吗'}" ng-click="rdssc.Delete(item)"><i class="glyphicon glyphicon-remove"></i></button>
                            </span>
                            <span ng-if="item.IsEdit">
                                <button class="btn btn-xs btn-success" ng-disabled="rdssc.EditForm.$invalid" ng-click="rdssc.SaveEdit($index)"><i class="glyphicon glyphicon-save"></i></button>
                                <button class="btn btn-xs btn-warning" ng-click="item.IsEdit=!item.IsEdit"><i class="fa fa-undo"></i></button>
                            </span>
                        </td>
                        <td>
                            {{item.RN}}
                        </td>
                        <td title="{{ item.DocNo }}">
                            <span>{{ item.DocNo }}</span>
                        </td>
                        <td title="{{ item.DocType }}">
                            <div ng-if="!item.IsEdit" ng-disabled="true" config-select ng-model="item.DocType" config-option="rdssc.DocTypeList" auto-first="false" ng-name="DocType" placeholder="单据类型"></div>
                            <div ng-if="item.IsEdit" ng-class="{ 'has-error': rdssc.EditForm.e_DocType.$invalid }">
                                <div config-select ng-model="rdssc.EditItem.DocType" config-option="rdssc.DocTypeList" auto-first="false" ng-name="e_DocType" placeholder="单据类型"></div>
                            </div>
                        </td>
                        <td style="white-space:normal;word-break:normal;">{{item.MaterialCode}}</td>
                        <td style="white-space:normal;word-break:normal;">{{item.MaterialName}}</td>
                        <td>{{item.Progress}}</td>
                        <td>
                            <span>{{ item.Count }}</span>
                        </td>
                        <td title="{{ item.Operator }}">
                            <span ng-if="!item.IsEdit">{{ item.Operator }}</span>
                            <div ng-if="item.IsEdit" ng-class="{ 'has-error': rdssc.EditForm.e_Operator.$invalid }">
                                <input type="text" name="e_Operator" class="form-control" placeholder="出库人" ng-model="rdssc.EditItem.Operator" required />
                            </div>
                        </td>
                        <td title="{{ item.DeliverDate }}">
                            <span ng-if="!item.IsEdit">{{ item.DeliverDate|date:'yyyy-MM-dd' }}</span>
                            <div ng-if="item.IsEdit" ng-class="{ 'has-error': rdssc.EditForm.e_DeliverDate.$invalid }">
                                <input type="text" date-picker name="e_DeliverDate" class="form-control" placeholder="出库日期" ng-model="rdssc.EditItem.DeliverDate" option="rdssc.DateOption" required />
                            </div>
                        </td>
                        <td title="{{ item.PlanReturnDate }}">
                            <span ng-if="!item.IsEdit">{{ item.PlanReturnDate|date:'yyyy-MM-dd' }}</span>
                            <div ng-if="item.IsEdit" >
                                <input type="text" date-picker name="e_PlanReturnDate" class="form-control" placeholder="计划归还日" ng-model="rdssc.EditItem.PlanReturnDate" option="rdssc.DateOption" />
                            </div>
                        </td>
                        <td>
                            <span ng-if="!item.IsEdit">{{ item.ProjectCode }}</span>
                            <div ng-if="item.IsEdit">
                                <div basic-select="PLMProject" name="e_Project" placeholder="PLM项目号"
                                     ng-model="rdssc.Project" >
                                </div>
                            </div>
                        </td>
                        <td style="white-space:normal;word-break:normal;">
                            <span ng-if="!item.IsEdit">{{ item.ProjectName }}</span>
                            <span ng-if="item.IsEdit">{{ rdssc.Project.WorkName }}</span>
                        </td>
                        <td title="{{ item.DeptName }}">
                            <span ng-if="!item.IsEdit">{{ item.DeptName }}</span>
                            <div ng-if="item.IsEdit" ng-class="{ 'has-error': rdssc.EditForm.e_Dept.$invalid }">
                                <div basic-select="TPDicRDDept" name="e_Dept" placeholder="领借部门"
                                     ng-model="rdssc.Dept">
                                </div>
                            </div>
                        </td>
                        <td>
                            <span ng-if="!item.IsEdit">{{ item.Borrower }}</span>
                            <div ng-if="item.IsEdit" ng-class="{ 'has-error': rdssc.EditForm.e_Borrower.$invalid }">
                                <input type="text" name="e_Borrower" class="form-control" placeholder="领借人" ng-model="rdssc.Borrower" required />
                                <!--<div basic-select="TPDicRDUser" name="e_Borrower" placeholder="领借人"
                                     ng-model="rdssc.Borrower">
                                </div>-->
                            </div>
                        </td>
                        <td title="{{ item.CustomerName }}">
                            <span ng-if="!item.IsEdit">{{ item.CustomerName }}</span>
                            <div ng-if="item.IsEdit">
                                <div basic-select="TPDicRDCustomer" name="e_CustomerName" placeholder="客户"
                                     ng-model="rdssc.Customer">
                                </div>
                            </div>
                        </td>
                        <td title="{{ item.Remark }}" style="white-space:normal;word-break:normal;">
                            <span ng-if="!item.IsEdit">{{ item.Remark }}</span>
                            <div ng-if="item.IsEdit">
                                <input type="text" name="e_Remark" class="form-control" placeholder="备注" ng-model="rdssc.EditItem.Remark" />
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="col-md-12 text-center " ng-if="rdssc.page.total>rdssc.page.pageSize ">
            <div uib-pagination total-items="rdssc.page.total " ng-model="rdssc.page.pageIndex " items-per-page="rdssc.page.pageSize " max-size="10 " first-text="第一页 " previous-text="上一页 "
                 ng-change="rdssc.DataBind() " next-text="下一页 " last-text="最后页 " boundary-links="true " boundary-link-numbers="true ">
            </div>
        </div>
    </uib-tab>
</uib-tabset>
