<div class="bg-light lter b-b wrapper-md" cg-busy="dailog.promise">
    <h3 class="m-n font-thin h3 text-center">
        系统弹跳窗路由设定
        <button class="btn btn-sm btn-success pull-left" ng-click="dailog.Insert()"><i class="glyphicon glyphicon-plus"></i> 新增</button>
    </h3>
</div>
<div class="wrapper-md" uib-collapse="dailog.isAdd">
    <div class="input-group m-b-xxs">
        <span class="input-group-addon input-sm no-border no-bg"><i class="icon-magnifier text-md m-t-xxs"></i></span>
        <input type="text" class="form-control input-sm no-border no-bg text-xs" placeholder="查询" ng-model="dailog.search">
    </div>
    <div>
        <table class="table table-striped b-2x" cg-busy="sys.promise">
            <tr class="text-center bg-gd-dk h4">
                <td class="col-md-1">编辑</td>
                <td class="col-md-1">Dailog</td>
                <td class="col-md-2">html文件</td>
                <td class="col-md-2">依赖js文件</td>
                <td class="col-md-2">Controller</td>
                <td class="col-md-1">ControllerAs</td>
            </tr>
            <tr ng-repeat="item in dailog.List | filter: dailog.search">
                <td>
                    <button class="btn btn-xs btn-primary" ng-click="dailog.Edit(item)"><i class="glyphicon glyphicon-edit"></i></button>
                    <button class="btn btn-xs btn-danger" ng-confirm="{text:'确定要删除吗'}" ng-click="sys.Delete(item)"><i class="glyphicon glyphicon-remove"></i></button>
                </td>
                <td>{{ item.name }}</td>
                <td>{{ item.templateUrl }}</td>
                <td>
                    <div class="list-group">
                        <a class="list-group" href="" ng-repeat="js in item.LoadFiles">{{ js }}</a>
                    </div>
                </td>
                <td>{{ item.controller }}</td>
                <td>
                    {{ item.controllerAs }}
                </td>
            </tr>
        </table>
    </div>
    <!--<div class="col-md-12 text-center">
        <uib-pagination total-items="sys.page.total" ng-model="sys.page.index" items-per-page="sys.page.size" max-size="4" class="pagination-sm" boundary-links="true"></uib-pagination>
    </div>-->
    <!--<pre>{{ sys.List | json }}</pre>-->
</div>
<div class="wrapper-md" uib-collapse="!dailog.isAdd">
    <div class="modal-body wrapper-md" ng-form="DailogForm">
        <div class="panel panel-default" ng-form="DailogForm">
            <div class="panel-heading"><h3 class="modal-title">弹出窗路由{{ dailog.form.title }}</h3></div>
            <div class="panel-body">
                <div class="form-horizontal col-lg-6">
                    <div class="form-group pull-in clearfix">
                        <label class="col-lg-3 control-label text-info">弹出窗名</label>
                        <div class="col-lg-9" ng-class="{ 'has-error' : DailogForm.name.$invalid }">
                            <input type="text" class="form-control" name="name" placeholder="弹出窗名"
                                   ng-model="dailog.NewItem.name" ng-disabled="dailog.form.index == 1" ng-blur="dailog.isExists()" required>
                            <div ng-messages="DailogForm.name.$error" class="help-block" role="alert">
                                <div ng-message="required">请输入弹出窗名</div>
                                <div ng-message="unique">弹出窗名重复</div>
                            </div>
                        </div>
                    </div>
                    <div class="form-group pull-in clearfix">
                        <label class="col-lg-3 control-label text-info">HTML文件</label>
                        <div class="col-lg-9" ng-class="{ 'has-error' : DailogForm.Html.$invalid }">
                            <div fun-file-select file-type="1" ng-model="fun.SelectedFun.FunHtml" clear="true" ng-name="Html" my-required="true"></div>
                            <div ng-messages="DailogForm.Html.$error" class="help-block" role="alert">
                                <div ng-message="required">请选择对应Html文件</div>
                            </div>
                        </div>
                    </div>
                    <div class="form-group pull-in clearfix">
                        <label class="col-lg-3 control-label text-info">控制器</label>
                        <div class="col-lg-9" ng-class="{ 'has-error' : DailogForm.Control.$invalid }">
                            <input class="form-control text-xs" name="Control" type="text" ng-model="fun.SelectedFun.RouteName" ng-disabled="!fun.editFun" required>
                            <div ng-messages="DailogForm.Control.$error" class="help-block" role="alert">
                                <div ng-message="required">请输入路由</div>
                            </div>
                        </div>
                    </div>
                    <div class="form-group pull-in clearfix">
                        <label class="col-lg-3 control-label text-info">控制器简写</label>
                        <div class="col-lg-9">
                            <input class="form-control text-xs" type="text" ng-model="fun.SelectedFun.ControllerAs" ng-disabled="!fun.editFun">
                        </div>
                    </div>
                    <div class="form-group pull-in clearfix">
                        <div class="input-group col-lg-9 col-lg-offset-3">
                            <span class="input-group-btn">
                                <button class="btn btn-default">
                                    <span class="glyphicon glyphicon-plus text-success" ng-click="fun.FunLoadAdd()"></span>
                                </button>
                            </span>
                            <div fun-file-select file-type="2" ng-model="fun.loadFile"></div>
                        </div>
                    </div>
                </div>

                <div class="panel panel-info">
                    <div class="panel-heading">依赖文件列表</div>
                    <div></div>
                </div>

            <div class="form-group py-xl-1 pt-xl-1">
                <label class="col-lg-1 control-label text-info">依赖文件</label>
                <div class="col-lg-10">
                    <div class="panel panel-default panel-body">
                        <div class="list-group no-radius no-border no-bg m-b-none">
                            <a ng-repeat="load in fun.SelectedFun.FunLoad | orderBy:'load.Orderby'"
                                class="list-group-item"
                                ng-drop="true" ng-drop-success="fun.FunLoadDrop($data,$index)">
                                <span ng-if="fun.editFun" ng-click='fun.FunLoadDelete($index)' class="pull-right text-danger">
                                    <i class="fa fa-times"></i>
                                </span>
                                <span class="block m-l-n bg-transparent">
                                    <i class="glyphicon glyphicon-move text-info" ng-drag="true" ng-if="fun.editFun"
                                        ng-drag-data="load" ng-drag-success="fun.FunLoadDrag($data,$index)"></i>{{ load.LoadName }}
                                </span>
                            </a>
                        </div>
                    </div>
                </div>
            </div>

        </div>
            <div class="panel-footer text-right">
                <button class="btn btn-success" type="button" ng-disabled="SystemForm.$invalid" ng-click="sys.Save()">储存</button>
                <button class="btn btn-warning" type="button" ng-click="sys.cancel()">取消</button>
            </div>
        </div>
    </div>
</div>

