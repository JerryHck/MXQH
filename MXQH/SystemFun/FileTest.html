<div cg-busy="file.promise">
    <div class="row">
        <div class="col-md-6">
            <div id="file1" import-sheet-js opts="file.FileData" ng-complete="file.Do()"></div>
        </div>
    </div>
    <!--<div id="file2" import-sheet-js opts="file.FileData2" ng-complete="file.Do2()"></div>-->
    <!--<div import-sheet-js opts="file.FileData3" ng-complete="file.Do()"></div>-->
    <!--<input type="file" import-sheet-js="" opts="file.FileData" ng-complete="file.Do()" />-->

    <!--<pre>{{ file.List | json }}</pre>-->
</div>

<body>
    文件浏览：
    <input type="file" id="images" multiple /><br />
    <progress id="pro" value="0"></progress>
    <div id="result"></div>


    <input type="button" value="显示" onclick="showdatelists();" />
    <input type="button" value="读取二进制" onclick="readerBinary();" />
    <script>
        var showdatelists = function () {
            var imageEle = document.getElementById("images");
            var filelist = imageEle.files;
            for (var i = 0; i < filelist.length; i++)
            {
                var file = filelist[i];
                div = document.createElement("div");
                div.innerHTML = "第" + (i + 1) + "个文件名字是：" + file.name + ",文件大小是：" + file.size + "文件类型是：" + file.type;
                document.body.appendChild(div);
            }
        }
    </script>
    <script>
        var reader = null;
        if (FileReader) {
            reader = new FileReader();
        }
        else {
            alert("不支持");
        }
        var readerBinary = function ()
        {
            reader.readAsArrayBuffer(document.getElementById("images").files[0]);
            var pro = document.getElementById("pro");
            pro.max = document.getElementById("images").files[0].size;
            //读取不中断则触发该事件
            reader.onprogress = function (evt)
            {
                pro.value = evt.loaded;
            }
        }
    </script>

</body>


